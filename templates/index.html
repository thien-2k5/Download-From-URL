<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description"
        content="T·∫£i video t·ª´ YouTube, Facebook, TikTok, Instagram v√† nhi·ªÅu n·ªÅn t·∫£ng kh√°c v·ªõi ti·∫øn tr√¨nh real-time">
    <title>üì• Video Downloader Pro</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}?v=NewUI">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.min.js"></script>

    <!-- Favicon -->
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üì•</text></svg>">
</head>

<body>
    <!-- Theme Toggle -->
    <div class="theme-toggle">
        <button class="theme-toggle-btn" id="themeToggle" onclick="toggleTheme()" title="Chuy·ªÉn ƒë·ªïi s√°ng/t·ªëi">
            <span class="icon" id="themeIcon">‚òÄÔ∏è</span>
        </button>
    </div>

    <!-- Animated Background -->
    <div class="bg-animation"></div>

    <!-- Floating Navigation -->
    <div class="nav-container">
        <div class="nav-pills">
            <button class="nav-item active" onclick="switchTab('download')">
                ‚¨á Download
            </button>
            <button class="nav-item" onclick="switchTab('queue')">
                üìÑ Queue <span class="badge" id="queueBadge">0</span>
            </button>
            <button class="nav-item" onclick="switchTab('history')">
                üìú History <span class="badge" id="historyBadge">0</span>
            </button>
        </div>
    </div>

    <div class="container">

        <!-- ================== DOWNLOAD TAB ================== -->
        <div id="downloadTab" class="tab-content active">
            <div class="box">
                <div class="header">
                    <h1>üì• Video Downloader Pro</h1>
                    <p class="subtitle">
                        H·ªó tr·ª£: YouTube, Facebook, Instagram, TikTok, Twitter v√† c√°c n·ªÅn t·∫£ng kh√°c
                    </p>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions row">
                    <button class="btn-secondary" onclick="pasteFromClipboard()">
                        üìã Paste t·ª´ Clipboard
                    </button>
                    <button class="btn-secondary" onclick="clearInput()">
                        üóë X√≥a
                    </button>
                </div>

                <!-- Input Section -->
                <div class="input-group">
                    <label class="input-label-text">Nh·∫≠p URLs (m·ªói d√≤ng 1 link)</label>
                    <textarea id="url" placeholder="D√°n link video v√†o ƒë√¢y (m·ªói d√≤ng 1 link)...
V√≠ d·ª•:
https://youtube.com/watch?v=abc123
https://tiktok.com/@user/video/123" autocomplete="off"></textarea>
                </div>

                <!-- Full Width Preview Button -->
                <button class="btn-preview full-width" onclick="previewVideo()">
                    üîç Preview
                </button>

                <!-- Video Preview Container (Hidden by default) -->
                <div id="videoPreview" class="video-preview" style="display: none; margin-top: 16px;">
                    <div class="preview-content">
                        <img id="previewThumbnail" src="" alt="Thumbnail" style="display: none;">
                        <div class="preview-info">
                            <h3 id="previewTitle"></h3>
                            <div class="preview-meta">
                                <span id="previewPlatform"></span>
                                <span id="previewDuration"></span>
                                <span id="previewViews"></span>
                            </div>
                            <div id="previewFormats" class="preview-formats"></div>
                        </div>
                        <button class="close-preview"
                            onclick="document.getElementById('videoPreview').style.display='none'">√ó</button>
                    </div>
                </div>

                <!-- Settings Rows -->
                <div class="settings-grid">
                    <div class="setting-item">
                        <label>Ch·ªçn ƒë·ªãnh d·∫°ng:</label>
                        <select id="format" class="custom-select">
                            <option value="mp4">üé¨ Video MP4</option>
                            <option value="mp3">üéµ Audio MP3 (Ch·ªâ √¢m thanh)</option>
                            <option value="auto">‚ú® T·ª± ƒë·ªông</option>
                        </select>
                    </div>

                    <div class="setting-item">
                        <label>Ch·∫•t l∆∞·ª£ng:</label>
                        <select id="quality" class="custom-select">
                            <option value="best">üåü T·ªët nh·∫•t</option>
                            <option value="2160p">üî• 4K (2160p)</option>
                            <option value="1440p">üíé 2K (1440p)</option>
                            <option value="1080p">‚ú® Full HD (1080p)</option>
                            <option value="720p">üì∫ HD (720p)</option>
                            <option value="480p">üì± SD (480p)</option>
                        </select>
                    </div>
                </div>

                <!-- Main Action Buttons -->
                <div class="main-actions row">
                    <button id="addQueueBtn" class="btn-primary" onclick="addToQueue()">
                        ‚ûï TH√äM V√ÄO QUEUE
                    </button>
                    <button id="downloadBtn" class="btn-accent" onclick="startDownload()">
                        <span id="btnText">‚¨á T·∫¢I NGAY</span>
                    </button>
                </div>

                <!-- Progress Container -->
                <div class="progress-container" id="progressContainer" style="display: none;">
                    <div class="status-header">
                        <div id="status" class="status-text">ƒêang chu·∫©n b·ªã...</div>
                        <div id="percent" class="percent-text">0%</div>
                    </div>
                    <div class="progress-bar-wrapper">
                        <div id="progressBar" class="progress-bar"></div>
                    </div>
                    <div id="videoTitle" class="video-title"></div>
                </div>

                <hr class="divider">

                <!-- Instructions -->
                <div class="instructions-section">
                    <h3>üìñ H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng:</h3>
                    <ol>
                        <li><strong>D√°n link video:</strong> Copy link t·ª´ YouTube, Facebook, Instagram, TikTok... r·ªìi
                            d√°n v√†o √¥ nh·∫≠p li·ªáu</li>
                        <li><strong>H·ªó tr·ª£ multi-URL:</strong> D√°n nhi·ªÅu link (m·ªói d√≤ng 1 link) ƒë·ªÉ t·∫£i h√†ng lo·∫°t</li>
                        <li><strong>Xem tr∆∞·ªõc:</strong> Nh·∫•n "üîç Preview" ƒë·ªÉ xem th√¥ng tin video tr∆∞·ªõc khi t·∫£i</li>
                        <li><strong>Ch·ªçn ƒë·ªãnh d·∫°ng:</strong> MP4 (video), MP3 (ch·ªâ √¢m thanh) ho·∫∑c T·ª± ƒë·ªông</li>
                        <li><strong>Th√™m v√†o Queue:</strong> Nh·∫•n "‚ûï TH√äM V√ÄO QUEUE" ƒë·ªÉ th√™m v√†o h√†ng ƒë·ª£i</li>
                        <li><strong>T·∫£i ngay:</strong> Nh·∫•n "‚¨á T·∫¢I NGAY" ƒë·ªÉ t·∫£i tr·ª±c ti·∫øp</li>
                    </ol>
                </div>

                <!-- Shortcuts -->
                <div class="shortcuts-section">
                    <h3>‚å® Ph√≠m t·∫Øt:</h3>
                    <div class="shortcut-grid">
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>V</kbd> <span>D√°n URL</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Enter</kbd> <span>T·∫£i ngay</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>Enter</kbd> <span>Th√™m v√†o Queue</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ================== QUEUE TAB ================== -->
        <div id="queueTab" class="tab-content">
            <div class="box">
                <div class="queue-header-main">
                    <h2>üìã H√†ng ƒë·ª£i t·∫£i xu·ªëng</h2>
                    <div class="header-actions">
                        <button class="btn-success small" onclick="startQueueDownload()">‚ñ∂ B·∫Øt ƒë·∫ßu t·∫£i</button>
                        <button class="btn-danger small" onclick="clearQueue()">üóë X√≥a t·∫•t c·∫£</button>
                    </div>
                </div>

                <div class="queue-list-container" id="queueList">
                    <div class="queue-empty">
                        <div class="queue-empty-img">üì¨</div>
                        <h3>H√†ng ƒë·ª£i tr·ªëng</h3>
                        <p>Th√™m video t·ª´ tab Download ƒë·ªÉ b·∫Øt ƒë·∫ßu</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ================== HISTORY TAB ================== -->
        <div id="historyTab" class="tab-content">
            <div class="box">
                <div class="queue-header-main">
                    <h2>üìú L·ªãch s·ª≠ t·∫£i xu·ªëng</h2>
                    <div class="header-actions">
                        <button class="btn-success small" onclick="exportHistory()">üì§ Export JSON</button>
                        <button class="btn-danger small" onclick="clearHistoryRecord()">üóë X√≥a t·∫•t c·∫£</button>
                    </div>
                </div>

                <!-- Search Bar -->
                <div class="search-bar">
                    <span class="search-icon">üîç</span>
                    <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm theo t√™n, platform, URL..."
                        oninput="searchHistory(this.value)" />
                </div>

                <!-- Filter Pills -->
                <div class="filter-pills">
                    <button class="filter-pill active" onclick="filterHistory('all')">T·∫•t c·∫£</button>
                    <button class="filter-pill success" onclick="filterHistory('success')">‚úÖ Th√†nh c√¥ng</button>
                    <button class="filter-pill failed" onclick="filterHistory('failed')">‚ùå Th·∫•t b·∫°i</button>
                    <button class="filter-pill" onclick="filterHistory('mp4')">üé¨ MP4</button>
                    <button class="filter-pill" onclick="filterHistory('mp3')">üéµ MP3</button>
                </div>

                <div id="historyList" class="history-list">
                    <div class="loading">ƒêang t·∫£i...</div>
                </div>

                <div id="historyEmpty" class="history-empty"
                    style="display:none; text-align: center; color: var(--text-muted); margin-top: 20px;">
                    ‚ùå L·ªói khi t·∫£i l·ªãch s·ª≠
                </div>
            </div>
        </div>

    </div>

    <script src="{{ url_for('static', filename='script.js') }}?v=NewUI"></script>
</body>

</html>